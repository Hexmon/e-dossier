# Audit Coverage Report (Hexmon v2)

Generated: 2026-02-08T20:05:32.876Z

## 1) Current implementation summary
- **Hexmon v2 (current target):** `src/lib/audit.ts` provides `withAuditRoute`, `auditLogger` (QUEUE mode), and `req.audit.log(...)` integration via `@hexmon_tech/audit-next`.
- **Sink/table used by Hexmon v2:** Postgres sink writes to `audit_events` (`src/app/db/schema/auth/audit-events.ts`).
- **Legacy path still present:** `src/lib/audit-log.ts` + `src/lib/withRouteLogging.ts` writes/uses `audit_logs` table and access logs; many routes still use it.
- **Actor/context pattern in v2:** routes pass `actor`, `target`, `action`, `outcome`, and safe `metadata` to `req.audit.log`; request-id propagation is handled in `withAuditRoute`.
- **Redaction:** v2 logger is created with redaction enabled (`redaction: { enabled: true }`). Legacy helper also redacts sensitive keys.
- **Storage/query alignment:** `/api/v1/admin/audit-logs` now reads from **both** `audit_logs` and `audit_events` so migrated and legacy routes appear together.

## 2) Coverage table

### Audited (Hexmon v2)
| Route | Methods | Audited? | Logged events (action/resource/outcome) | Notes |
|---|---|---|---|---|
| `/api/v1/admin/appointments/[id]` | GET (withAuditRoute), PATCH (withAuditRoute), DELETE (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.APPOINTMENT_UPDATED / AuditResourceType.APPOINTMENT / 'SUCCESS'; AuditEventType.APPOINTMENT_DELETED / AuditResourceType.APPOINTMENT / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/appointments/[id]/transfer` | POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.APPOINTMENT_TRANSFERRED / AuditResourceType.APPOINTMENT / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/appointments` | GET (withAuditRoute), POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.APPOINTMENT_CREATED / AuditResourceType.APPOINTMENT / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/audit-logs` | GET (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.API_REQUEST / AuditResourceType.API / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/training-camps/[campId]/activities/[activityId]` | GET (withAuditRoute), PATCH (withAuditRoute), DELETE (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.TRAINING_CAMP_ACTIVITY_UPDATED / AuditResourceType.TRAINING_CAMP_ACTIVITY / 'SUCCESS'; AuditEventType.TRAINING_CAMP_ACTIVITY_DELETED / AuditResourceType.TRAINING_CAMP_ACTIVITY / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/training-camps/[campId]/activities` | GET (withAuditRoute), POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.TRAINING_CAMP_ACTIVITY_CREATED / AuditResourceType.TRAINING_CAMP_ACTIVITY / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/training-camps/[campId]` | GET (withAuditRoute), PATCH (withAuditRoute), DELETE (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.TRAINING_CAMP_UPDATED / AuditResourceType.TRAINING_CAMP / 'SUCCESS'; AuditEventType.TRAINING_CAMP_DELETED / AuditResourceType.TRAINING_CAMP / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/training-camps` | GET (withAuditRoute), POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.TRAINING_CAMP_CREATED / AuditResourceType.TRAINING_CAMP / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/users/[id]` | GET (withAuditRoute), PATCH (withAuditRoute), DELETE (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.USER_UPDATED / AuditResourceType.USER / 'SUCCESS'; AuditEventType.USER_DELETED / AuditResourceType.USER / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/users/check-username` | GET (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.API_REQUEST / AuditResourceType.USER / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/admin/users` | GET (withAuditRoute), POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.USER_CREATED / AuditResourceType.USER / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/appointments/[id]/active-user` | GET (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.API_REQUEST / AuditResourceType.APPOINTMENT / 'FAILURE'; AuditEventType.API_REQUEST / AuditResourceType.APPOINTMENT / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/auth/login` | POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.API_REQUEST / ? / 'FAILURE'; AuditEventType.LOGIN_FAILURE / AuditResourceType.USER / 'DENIED'; AuditEventType.LOGIN_FAILURE / AuditResourceType.USER / 'FAILURE'; AuditEventType.ACCOUNT_LOCKED / AuditResourceType.USER / 'DENIED' | withAuditRoute + req.audit.log |
| `/api/v1/auth/logout` | POST (withAuditRoute), OPTIONS (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.LOGOUT / AuditResourceType.USER / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/auth/signup` | POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.API_REQUEST / AuditResourceType.API / 'FAILURE'; AuditEventType.SIGNUP_REQUEST_CREATED / AuditResourceType.SIGNUP_REQUEST / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/bootstrap/super-admin` | POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.USER_CREATED / AuditResourceType.USER / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/health` | GET (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.API_REQUEST / AuditResourceType.API / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/me` | GET (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.API_REQUEST / AuditResourceType.USER / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/oc` | GET (withAuditRoute), POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.OC_CREATED / AuditResourceType.OC / 'SUCCESS'; AuditEventType.API_REQUEST / AuditResourceType.OC / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/platoons/[idOrKey]` | PATCH (withAuditRoute), DELETE (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.PLATOON_UPDATED / AuditResourceType.PLATOON / 'SUCCESS'; AuditEventType.PLATOON_DELETED / AuditResourceType.PLATOON / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/platoons` | GET (withAuditRoute), POST (withAuditRoute), DELETE (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.PLATOON_CREATED / AuditResourceType.PLATOON / 'SUCCESS'; AuditEventType.PLATOON_DELETED / AuditResourceType.PLATOON / 'SUCCESS' | withAuditRoute + req.audit.log |
| `/api/v1/roles` | GET (withAuditRoute), POST (withAuditRoute) | Audited (Hexmon v2) | AuditEventType.API_REQUEST / AuditResourceType.ROLE / 'SUCCESS' | withAuditRoute + req.audit.log |

### Partially audited
| Route | Methods | Audited? | Logged events (action/resource/outcome) | Notes |
|---|---|---|---|---|
| `/api/v1/admin/courses/[courseId]/offerings/[offeringId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.COURSE_OFFERING_UPDATED / AuditResourceType.OFFERING / ?; AuditEventType.COURSE_OFFERING_DELETED / AuditResourceType.OFFERING / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/courses/[courseId]/offerings` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.COURSE_OFFERING_CREATED / AuditResourceType.OFFERING / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/courses/[courseId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.COURSE_UPDATED / AuditResourceType.COURSE / ?; AuditEventType.COURSE_DELETED / AuditResourceType.COURSE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/courses` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.COURSE_CREATED / AuditResourceType.COURSE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/discipline/[id]` | PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/discipline` | GET (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/instructors/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.INSTRUCTOR_UPDATED / AuditResourceType.INSTRUCTOR / ?; AuditEventType.INSTRUCTOR_DELETED / AuditResourceType.INSTRUCTOR / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/instructors` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.INSTRUCTOR_CREATED / AuditResourceType.INSTRUCTOR / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/fields/[fieldId]/options/[optionId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_FIELD_OPTION_UPDATED / AuditResourceType.INTERVIEW_FIELD_OPTION / ?; AuditEventType.INTERVIEW_FIELD_OPTION_DELETED / AuditResourceType.INTERVIEW_FIELD_OPTION / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/fields/[fieldId]/options` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_FIELD_OPTION_CREATED / AuditResourceType.INTERVIEW_FIELD_OPTION / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/fields/[fieldId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_FIELD_UPDATED / AuditResourceType.INTERVIEW_FIELD / ?; AuditEventType.INTERVIEW_FIELD_DELETED / AuditResourceType.INTERVIEW_FIELD / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/groups/[groupId]/fields` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_FIELD_CREATED / AuditResourceType.INTERVIEW_FIELD / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/groups/[groupId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_GROUP_UPDATED / AuditResourceType.INTERVIEW_GROUP / ?; AuditEventType.INTERVIEW_GROUP_DELETED / AuditResourceType.INTERVIEW_GROUP / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/groups` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_GROUP_CREATED / AuditResourceType.INTERVIEW_GROUP / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_TEMPLATE_UPDATED / AuditResourceType.INTERVIEW_TEMPLATE / ?; AuditEventType.INTERVIEW_TEMPLATE_DELETED / AuditResourceType.INTERVIEW_TEMPLATE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/sections/[sectionId]/fields` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_FIELD_CREATED / AuditResourceType.INTERVIEW_FIELD / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/sections/[sectionId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_SECTION_UPDATED / AuditResourceType.INTERVIEW_SECTION / ?; AuditEventType.INTERVIEW_SECTION_DELETED / AuditResourceType.INTERVIEW_SECTION / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/sections` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_SECTION_CREATED / AuditResourceType.INTERVIEW_SECTION / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/semesters/[semester]` | DELETE (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_TEMPLATE_SEMESTER_REMOVED / AuditResourceType.INTERVIEW_TEMPLATE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates/[templateId]/semesters` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_TEMPLATE_SEMESTER_ADDED / AuditResourceType.INTERVIEW_TEMPLATE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/interview/templates` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.INTERVIEW_TEMPLATE_CREATED / AuditResourceType.INTERVIEW_TEMPLATE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/motivation-fields/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.PT_MOTIVATION_FIELD_UPDATED / AuditResourceType.PT_MOTIVATION_FIELD / ?; AuditEventType.PT_MOTIVATION_FIELD_DELETED / AuditResourceType.PT_MOTIVATION_FIELD / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/motivation-fields` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.PT_MOTIVATION_FIELD_CREATED / AuditResourceType.PT_MOTIVATION_FIELD / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/templates` | GET (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]/attempts/[attemptId]/grades/[gradeId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.PT_GRADE_UPDATED / AuditResourceType.PT_GRADE / ?; AuditEventType.PT_GRADE_DELETED / AuditResourceType.PT_GRADE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]/attempts/[attemptId]/grades` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.PT_GRADE_CREATED / AuditResourceType.PT_GRADE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]/attempts/[attemptId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.PT_ATTEMPT_UPDATED / AuditResourceType.PT_ATTEMPT / ?; AuditEventType.PT_ATTEMPT_DELETED / AuditResourceType.PT_ATTEMPT / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]/attempts` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.PT_ATTEMPT_CREATED / AuditResourceType.PT_ATTEMPT / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.PT_TYPE_UPDATED / AuditResourceType.PT_TYPE / ?; AuditEventType.PT_TYPE_DELETED / AuditResourceType.PT_TYPE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]/tasks/[taskId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.PT_TASK_UPDATED / AuditResourceType.PT_TASK / ?; AuditEventType.PT_TASK_DELETED / AuditResourceType.PT_TASK / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]/tasks/[taskId]/scores/[scoreId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.PT_TASK_SCORE_UPDATED / AuditResourceType.PT_TASK_SCORE / ?; AuditEventType.PT_TASK_SCORE_DELETED / AuditResourceType.PT_TASK_SCORE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]/tasks/[taskId]/scores` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.PT_TASK_SCORE_CREATED / AuditResourceType.PT_TASK_SCORE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types/[typeId]/tasks` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.PT_TASK_CREATED / AuditResourceType.PT_TASK / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/physical-training/types` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.PT_TYPE_CREATED / AuditResourceType.PT_TYPE / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/positions/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.POSITION_UPDATED / AuditResourceType.POSITION / ?; AuditEventType.POSITION_DELETED / AuditResourceType.POSITION / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/positions/active-holder` | GET (withRouteLogging) | Partially Audited | AuditEventType.API_REQUEST / AuditResourceType.POSITION / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/positions` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.POSITION_CREATED / AuditResourceType.POSITION / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/positions/slots` | GET (withRouteLogging) | Partially Audited | AuditEventType.API_REQUEST / AuditResourceType.POSITION / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/punishments/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.PUNISHMENT_UPDATED / AuditResourceType.PUNISHMENT / ?; AuditEventType.PUNISHMENT_DELETED / AuditResourceType.PUNISHMENT / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/punishments` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.PUNISHMENT_CREATED / AuditResourceType.PUNISHMENT / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/signup-requests/[id]/approve` | POST (withRouteLogging) | Partially Audited | AuditEventType.SIGNUP_REQUEST_APPROVED / AuditResourceType.SIGNUP_REQUEST / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/signup-requests/[id]/reject` | POST (withRouteLogging) | Partially Audited | AuditEventType.SIGNUP_REQUEST_REJECTED / AuditResourceType.SIGNUP_REQUEST / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/signup-requests/[id]` | DELETE (withRouteLogging) | Partially Audited | AuditEventType.SIGNUP_REQUEST_DELETED / AuditResourceType.SIGNUP_REQUEST / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/signup-requests` | GET (withRouteLogging) | Partially Audited | AuditEventType.API_REQUEST / AuditResourceType.SIGNUP_REQUEST / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/subjects/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.SUBJECT_UPDATED / AuditResourceType.SUBJECT / ?; AuditEventType.SUBJECT_DELETED / AuditResourceType.SUBJECT / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/admin/subjects` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.SUBJECT_CREATED / AuditResourceType.SUBJECT / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/auth/change-password` | POST (withRouteLogging) | Partially Audited | AuditEventType.PASSWORD_CHANGED / AuditResourceType.USER / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/academics/[semester]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/academics/[semester]/subjects/[subjectId]` | PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/academics` | GET (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/achievements/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/achievements` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/autobiography` | GET (withRouteLogging), POST (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/camps` | GET (withRouteLogging), POST (withRouteLogging), PUT (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/club-achievements/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/club-achievements` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/clubs/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/clubs` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/counselling/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/counselling` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/credit-for-excellence/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/credit-for-excellence` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/discipline/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/discipline` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/dossier-filling` | GET (withRouteLogging), POST (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/dossier-inspection` | GET (withRouteLogging), POST (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/dossier-snapshot` | GET (withRouteLogging), POST (withRouteLogging), PUT (withRouteLogging), PATCH (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/drill/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/drill` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/education/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/education` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/family/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/family` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/images/complete` | POST (withRouteLogging) | Partially Audited | existing ? AuditEventType.OC_RECORD_UPDATED : AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/images/presign` | POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/images` | GET (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/interviews/[interviewId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/interviews` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/medical-category/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/medical-category` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/medical/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/medical` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/motivation-awards/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/motivation-awards` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/obstacle-training/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/obstacle-training` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/olq/[id]` | GET (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/olq/by-semester` | GET (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/olq/categories/[categoryId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/olq/categories` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/olq` | GET (withRouteLogging), POST (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/olq/subtitles/[subtitleId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/olq/subtitles` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/parent-comms/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/parent-comms` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/personal` | GET (withRouteLogging), POST (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/physical-training/motivation-awards` | GET (withRouteLogging), POST (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/physical-training` | GET (withRouteLogging), POST (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/recording-leave-hike-detention/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/recording-leave-hike-detention` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/special-achievement-in-firing/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/special-achievement-in-firing` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/speed-march/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/speed-march` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/sports-and-games/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/sports-and-games` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/ssb/points/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/ssb/points` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/ssb` | GET (withRouteLogging), POST (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/weapon-training/[id]` | GET (withRouteLogging), PATCH (withRouteLogging), DELETE (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_UPDATED / AuditResourceType.OC / ?; AuditEventType.OC_RECORD_DELETED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/[ocId]/weapon-training` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | AuditEventType.OC_RECORD_CREATED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/academics/bulk` | GET (withRouteLogging), POST (withRouteLogging) | Partially Audited | Access logs only | Legacy path only: withRouteLogging/createAuditLog |
| `/api/v1/oc/bulk-upload` | POST (withRouteLogging) | Partially Audited | AuditEventType.OC_BULK_IMPORTED / AuditResourceType.OC / ? | Legacy path only: withRouteLogging/createAuditLog |

### Not audited
| Route | Methods | Audited? | Logged events (action/resource/outcome) | Notes |
|---|---|---|---|---|
| _None detected_ | n/a | n/a | n/a | n/a |

## 3) Rollout plan (next batches)
- **Batch 1 (completed in this change):** Auth + bootstrap + identity + OC index/creation + roles read/write + audit log aggregation endpoint.
  - Updated: `src/app/api/v1/auth/logout/route.ts`, `src/app/api/v1/auth/signup/route.ts`, `src/app/api/v1/me/route.ts` (typing fixes only), `src/app/api/v1/bootstrap/super-admin/route.ts` (already v2), `src/app/api/v1/oc/route.ts`, `src/app/api/v1/roles/route.ts`, `src/app/api/v1/admin/audit-logs/route.ts`, `src/app/lib/auditLogsQuery.ts`.
- **Batch 2 (recommended):** Admin users/roles/positions/courses endpoints still on legacy helper: move to `withAuditRoute` + `req.audit.log`.
- **Batch 3 (recommended):** Admin physical-training + interview template endpoints.
- **Batch 4 (recommended):** OC sub-resource endpoints (`/api/v1/oc/[ocId]/**`) currently legacy-heavy.
- **Batch 5 (recommended):** Final legacy clean-up and remove/retire `withRouteLogging`/`createAuditLog` once fully migrated.

## 4) Risks / edge cases
- Mixed storage period: events currently live in both `audit_logs` and `audit_events`; dedup/order is handled in API by merge-sort and combined counts.
- Legacy routes remain partially migrated and may not emit the exact v2 event shape until converted.
- Query pagination across merged tables currently fetches `limit + offset` from each table before merge; correct but heavier for very high offsets.
- Some test files include duplicated mock keys (warnings only); not blocking but should be cleaned.
